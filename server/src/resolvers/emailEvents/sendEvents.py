import yagmail
import sys, json

recipientEmail = 'svenacious@gmail.com' #Replace this by your email to until you're done working
list_of_events = json.loads(sys.argv[2])

# print(list_of_events['image'])
# print('Argument List:', str(sys.argv))
# print(x)

#this loop is solely for developement purpose remove it when done
for event in list_of_events:
    print("============")
    print(event['title'])

# This is a templat, it is used when we send a verifaciton email
emailHtml = '''<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><title>Traveling Strategy</title></head><body leftmargin="0" marginwidth="0" topmargin="0" marginheight="0" offset="0" style="margin: 0pt auto; padding-left: 90px; padding-right: 90px; background:#F4F7FA;"><table id="main" width="100%" height="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#F4F7FA"><tbody><tr><td valign="top"><table class="innermain" cellpadding="0" width="580" cellspacing="0" border="0" bgcolor="#F4F7FA" align="center" style="margin:0 auto; table-layout: fixed;"><tbody><tr><td colspan="6"><table class="logo" width="100%" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td colspan="2" height="30"></td></tr><tr><td valign="top" align="center"><a href="https://www.travelingstrategy.com" style="display:inline-block; cursor:pointer; text-align:center;"><img src="https://media0.giphy.com/media/dYUslDahf6Uw71gH3t/giphy.gif" height="150" width="150" border="0" alt="TravelingStrategy"/></a></td></tr><tr><td align="center" valign="bottom" colspan="2"><img alt="TravelingStrategy" width="300" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-tsux5brk51t/editor_images/toppng.png"/></td></tr><tr><td colspan="2" height="30"></td></tr></tbody></table><table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff" style="border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);"><tbody><tr><td height="40"></td></tr><tr style="font-family: -apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif; color:#4E5C6E; font-size:14px; line-height:20px; margin-top:20px;"><td class="content" colspan="2" valign="top" align="center" style="padding-left:90px; padding-right:90px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tbody><tr><td height="24"></td></tr><tr><td height="2" bgcolor="#DAE1E9"></td></tr><tr><td height="24"></td></tr><tr><td height="30"></td></tr><tr><td align="center"><span style="color:#48545d;font-size:38px;font-weight:bold;line-height:38px;">LIFE IS AN EXPERIMENT IN WHICH YOU FAIL OR SUCCEED. EXPLORE MORE, EXPECT LEAST.</span></td></tr><tr><td height="30"></td></tr><tr><td height="24"></td></tr><tr><td height="2" bgcolor="#DAE1E9"></td></tr><tr><td height="24"></td></tr><tr><td align="center"><span style="color:#a2a2a2;font-size:10px;line-height:24px;">Here is one of the events on your interest list.</span></td></tr><tr><td height="24"></td></tr><tr><td valign="top" width="48%" align="center"><img src={image} alt="events" width="350" height="200" style="display:block; padding:15px 25px; background-color:#DAE1E9; color:#ffffff; border-radius:3px; text-decoration:none;" /></td></tr><tr><td height="24"></td></tr><tr><td align="center"><span style="color:#48545d;font-size:20px;line-height:18px;font-weight:bold">{title}</span></td></tr><tr><td height="24"></td></tr><tr><td align="center"><p style="color:#667885; font-size:12px; line-height:17px; font-style:italic;">{description}</p></td></tr><tr><td height="24"></td></tr><tr><td height="5" bgcolor="#DAE1E9"></td></tr></tbody></table><table id="promo" width="100%" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td colspan="2"></td></tr><tr><td colspan="2" height="20"></td></tr><tr><td height="24"></td></tr><tr><td valign="top" width="50%" align="right"><img style="display:inline-block;margin-right:10px;" src="https://d15k2d11r6t6rl.cloudfront.net/public/users/BeeFree/beefree-tsux5brk51t/editor_images/giphy2_1.gif" height="180" width="200" border="0" alt="giphy"/></td><td valign="top"><p style="color:#a2a2a2; font-size:25px; line-height:25px; font-style:italic; font-weight:bold; display:inline-block; margin-left:5px; margin-top:30px;">GO DISCOVER NEW EVENTS FOR YOUR<span style="color:#ff6e61; font-size:25px; line-height:25px; font-style:italic; font-weight:bold; display:inline-block;">NEXT DESTINATION</span></p></td></tr><tr><td colspan="2" height="20"></td></tr><tr><td height="24"></td></tr></tbody></table><table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tbody><tr><td align="center"><span><a href="https://www.travelingstrategy.com" style="display:block; padding:15px 25px; background-color:#ff6e61; color:#ffffff; border-radius:3px;text-decoration:none;">Visit our website</a></span></td></tr></tbody></table><table id="promo" width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-top:20px;"><tbody><tr><td colspan="2" height="20"></td></tr><tr><td height="60"></td></tr><tr><td colspan="2" align="center"><span style="font-size:14px; font-weight:500; margin-bottom:10px; color:#7E8A98; font-family: -apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;">Stay on the lookout for our new TravelingStrategy App</span></td></tr><tr><td colspan="2" height="20"></td></tr><tr><td valign="top" width="50%" align="right"><a href="#" style="display:inline-block;margin-right:10px;"><img src="https://i.imgur.com/vtJsCmN.png" height="40" border="0" alt="TravelingStrategy iOS mobile app"/></a></td><td valign="top"><a href="#" style="display:inline-block;margin-left:5px;" ><img src="https://i.imgur.com/maleUl2.png" height="40" border="0" alt="TravelingStrategy Android mobile app"/></a></td></tr><tr><td colspan="2" height="20"></td></tr></tbody></table><table width="100%" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td height="50"></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table><table width="100%" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td height="10"> </td></tr><tr><td valign="top" align="center"><a href="https://www.travelingstrategy.com" style="display:inline-block; cursor:pointer; text-align:center;"><img src="https://travelingstrategy.com/static/media/logo.541e4d6e.png" height="54" width="54" border="0" alt="TravelingStrategy"/></a></td></tr><tr><td valign="top" align="center"><span style="font-family: -apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif; color:#9EB0C9; font-size:10px;">©<a href="https://www.travelingstrategy.com/" target="_blank" style="color:#9EB0C9 !important; text-decoration:none;">TravelingStrategy</a>2020</span></td></tr><tr><td height="50"></td></tr></tbody></table></td></tr></tbody></table></body></html>'''.format_map({'image': list_of_events[0]['image'], 'title':list_of_events[0]['title'], 'description': list_of_events[0]['description'] })

yag = yagmail.SMTP('noreply.travelingstrategy@gmail.com', 'Soen490!@#')
yag.send(recipientEmail, 'TravelingStrategy', emailHtml)
